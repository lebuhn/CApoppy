---
title: "Ecophysiological variation in petal water content traits across populations of Eschscholzia californica"
author: "Gretchen"
date: today
format: pdf
bibliography: references.bib
---

# Abstract

We examined microgeographic variation in petal water content traits across four populations of *Eschscholzia californica* at the Dangermond Preserve to understand how tissue economics and water relations vary among closely spaced populations experiencing distinct microhabitat conditions. Using fresh and dry weight measurements from populations spanning coastal dune and inland shale hillside environments within a 2 km radius, we calculated key tissue economics metrics including relative water content (RWC), dry matter content (DMC), and water storage capacity. Our analysis revealed significant variation in all 3 traits across populations and differences between coastal and inland strategies. These findings suggest that petal tissue economics can vary significantly even at microgeographic scales, reflecting fine-scale adaptation to local microhabitat conditions including substrate type, proximity to ocean, and microclimatic variation.

**Keywords:** petal ecophysiology, tissue economics, microgeographic variation, coastal ecology, *Eschscholzia californica*, Dangermond Preserve

# Introduction

Plant tissue economics theory provides a framework for understanding how organisms allocate resources to different tissues and the functional consequences of these allocation patterns. While extensively studied in leaves, the application of tissue economics principles to reproductive structures like petals remains relatively unexplored. Petals represent a unique challenge in plant resource allocation as they must balance structural integrity with visual display function while minimizing construction costs.

Microgeographic variation in plant functional traits can reveal how populations respond to fine-scale environmental heterogeneity over short spatial distances. Coastal California environments are particularly well-suited for studying such variation due to steep environmental gradients that occur over small spatial scales, including substrate composition, salt exposure, moisture availability, and microclimatic conditions.

For flowers, three factors are thought to influence floral traits reproductive assurance, enemy deterrence, stress resistance (Roddy 2020). A floral economics spectrum. Floral mass per area (FMA), flower size, floral longevity

*Eschscholzia californica* (California poppy) provides an excellent model system for examining petal tissue economics across microgeographic gradients. At the Dangermond Preserve, populations occur within a 2 km radius but experience markedly different microhabitat conditions, from exposed coastal dunes to protected inland shale hillsides. These contrasting environments likely impose different physiological constraints on petal construction and maintenance strategies.

We examined variation in petal water content traits across four populations of *E. californica* at the Dangermond Preserve to test the hypothesis that populations exhibit divergent tissue economics strategies reflecting local microhabitat conditions. Specifically, we predicted that the coastal dune population would exhibit higher dry matter content (more economical, salt-tolerant tissues) compared to inland populations, while populations on different substrate types (dune sand vs. shale) would show distinct water storage strategies reflecting substrate-specific water availability patterns.

# Methods

## Plant Material and Sampling

*Eschscholzia californica* petals were collected from four populations within a 2 km radius at the Dangermond Preserve, Santa Barbara County, California. The study populations represent distinct microhabitat types along a coastal-inland gradient:

**Coastal populations:** 1. **Pt. Conception** (34.454467°N, -120.46931°W): Coastal dune habitat with sandy substrate, high salt exposure, and direct ocean influence 2. **Percos** (34.451157°N, -120.444829°W): Shale hillside very close to the beach, experiencing moderate salt exposure and ocean influence

**Inland populations:** 3. **Perry** (34.460931°N, -120.450441°W): Inland shale hillside with reduced ocean influence and lower salt exposure 4. **Cojo** (34.458803°N, -120.444922°W): Inland shale hillside habitat with intermediate characteristics

These populations span a microgeographic gradient from exposed coastal environments to more protected inland sites, providing contrasting conditions for substrate type, moisture availability, salt exposure, and microclimatic variation. Sampling was conducted across multiple temporal blocks to account for seasonal variation in physiological traits. For each sample, fresh weight was measured immediately upon collection, followed by dry weight determination after drying for 48 hours at 80 degrees C in a drying oven.

## Tissue Economics Metrics

Following established tissue economics frameworks, we calculated several key metrics from fresh and dry weight measurements:

-   **Relative Water Content (RWC)**: $RWC = \frac{FW - DW}{FW} \times 100$
-   **Dry Matter Content (DMC)**: $DMC = \frac{DW}{FW}$\
-   **Water content per unit dry mass**: $\frac{FW - DW}{DW}$

Where FW = fresh weight and DW = dry weight.

## Statistical Analysis

We used generalized linear models (GLMs) to examine population and temporal (block) effects on petal traits, with block treated as a fixed effect to account for systematic temporal variation. For proportion data (dry matter content, relative water content), we used appropriate link functions (logit for proportions). We also analyzed coastal versus inland effects using GLMs with location type (coastal vs. inland) as a main effect along with temporal blocks.

Model selection was based on residual diagnostics and AIC comparison. Analysis of variance (ANOVA) was used to test for significant population, location type, and block effects.

Correlation structure among traits was examined using Pearson correlation coefficients. Mantel tests were used to compare correlation matrices between populations and blocks to test for divergent physiological strategies.

All analyses were conducted in R version \[X\] using packages lmerTest, vegan, and ggplot2.

# Results

```{r setup, echo=FALSE, message=FALSE, warning=FALSE}
# Load necessary packages
library(readr)
library(ggplot2)
library(dplyr)
library(emmeans)
library(lmerTest)
library(vegan)
library(knitr)
library(gridExtra)
library(kableExtra)

# Load the correct data
data_raw <- read_csv("../data/raw/plant/petal_weight_2025.csv")

# Filter out the specific Cojo plant 1 observation
data_filtered <- data_raw %>%
  filter(!(population == "Cojo" & plant == 1 & block == "1"))

# Filter data to include only "petal" (not petal2, petal3, petal4)

data <- data_filtered %>%
  filter(petal_flower == "petal")

# Convert columns
data$block <- as.factor(data$block)
data$population <- as.factor(data$population)
data$wet_wgt <- as.numeric(data$wet_wgt)
data$dry_wgt <- as.numeric(data$dry_wgt)
data$water_mg <- as.numeric(data$water_mg)
# change % to percent for column name
data$water_percent <- as.numeric(gsub("%", "", data$`water_%`))


# Calculate ecophysiological metrics
data <- data %>%
  mutate(
    relative_water_content = ((wet_wgt - dry_wgt) / wet_wgt) * 100,
    water_per_dry_mass = (wet_wgt - dry_wgt) / dry_wgt,
    dry_matter_content = dry_wgt / wet_wgt,
    tissue_density_proxy = dry_wgt / wet_wgt,
    # Add coastal vs inland classification
    location_type = case_when(
      population %in% c("Percos", "Pt. Conception") ~ "Coastal",
      population %in% c("Cojo", "Perry") ~ "Inland",
      TRUE ~ NA_character_
    )
  )

# Convert location_type to factor
data$location_type <- as.factor(data$location_type)

# Future petal area metrics (commented out - add when area data available)
# data <- data %>%
#   mutate(
#     specific_petal_area = petal_area / dry_wgt,
#     petal_mass_per_area = dry_wgt / petal_area,
#     fresh_mass_per_area = wet_wgt / petal_area,
#     thickness_proxy = wet_wgt / petal_area
#   )
```

## Population and Temporal Variation in Petal Traits

```{r create-summary-data, echo=FALSE}
# Create summary statistics tables (but don't display them yet)
trait_means_pop <- data %>%
  group_by(population, location_type) %>%
  summarise(
    n = n(),
    fresh_weight = round(mean(wet_wgt, na.rm = TRUE), 3),
    dry_weight = round(mean(dry_wgt, na.rm = TRUE), 3),
    rwc_percent = round(mean(relative_water_content, na.rm = TRUE), 1),
    dmc = round(mean(dry_matter_content, na.rm = TRUE), 3),
    water_dry_mass = round(mean(water_per_dry_mass, na.rm = TRUE), 2),
    .groups = "drop"
  )

trait_means_location <- data %>%
  group_by(location_type) %>%
  summarise(
    n = n(),
    fresh_weight = round(mean(wet_wgt, na.rm = TRUE), 3),
    dry_weight = round(mean(dry_wgt, na.rm = TRUE), 3),
    rwc_percent = round(mean(relative_water_content, na.rm = TRUE), 1),
    dmc = round(mean(dry_matter_content, na.rm = TRUE), 3),
    water_dry_mass = round(mean(water_per_dry_mass, na.rm = TRUE), 2),
    .groups = "drop"
  )
```

```{r}
#| label: tbl-trait-means-pop
#| tbl-cap: "Mean petal trait values by population and location type"
#| echo: false

kable(trait_means_pop, 
      col.names = c("Population", "Location", "n", "Fresh Weight (mg)", "Dry Weight (mg)", 
                   "RWC (%)", "DMC (g/g)", "Water/Dry Mass"))
```

```{r}
#| label: tbl-trait-means-location
#| tbl-cap: "Mean petal trait values by location type (coastal vs inland)"
#| echo: false

kable(trait_means_location, 
      col.names = c("Location Type", "n", "Fresh Weight (mg)", "Dry Weight (mg)", 
                   "RWC (%)", "DMC (g/g)", "Water/Dry Mass"))
```

```{r statistical-models, echo=FALSE}
# Generalized Linear Models
# For proportion data (DMC, RWC as proportion), use appropriate transformations
data_models <- data %>%
  mutate(
    rwc_prop = relative_water_content / 100,  # Convert to 0-1 scale
    # For GLM with logit link, need to handle boundary values
    rwc_prop_adj = pmax(pmin(rwc_prop, 0.999), 0.001),
    dmc_adj = pmax(pmin(dry_matter_content, 0.999), 0.001)
  )

# Population-level models
model_rwc_pop <- glm(rwc_prop_adj ~ population * block, 
                     data = data_models, family = quasibinomial(link = "logit"))
model_dmc_pop <- glm(dmc_adj ~ population * block, 
                     data = data_models, family = quasibinomial(link = "logit"))
model_water_dry_pop <- glm(water_per_dry_mass ~ population * block, 
                           data = data_models, family = Gamma(link = "log"))

# Coastal vs Inland models
model_rwc_location <- glm(rwc_prop_adj ~ location_type * block, 
                          data = data_models, family = quasibinomial(link = "logit"))
model_dmc_location <- glm(dmc_adj ~ location_type * block, 
                          data = data_models, family = quasibinomial(link = "logit"))
model_water_dry_location <- glm(water_per_dry_mass ~ location_type * block, 
                                data = data_models, family = Gamma(link = "log"))

# Extract ANOVA results
anova_rwc_pop <- anova(model_rwc_pop, test = "F")
anova_dmc_pop <- anova(model_dmc_pop, test = "F")
anova_water_dry_pop <- anova(model_water_dry_pop, test = "F")

anova_rwc_location <- anova(model_rwc_location, test = "F")
anova_dmc_location <- anova(model_dmc_location, test = "F")
anova_water_dry_location <- anova(model_water_dry_location, test = "F")
```

**Population-level Effects:** Analysis of variance using generalized linear models revealed significant population effects for relative water content (F = `r round(anova_rwc_pop["population", "F"], 2)`, P = `r round(anova_rwc_pop["population", "Pr(>F)"], 5)`) and dry matter content (F = `r round(anova_dmc_pop["population", "F"], 2)`, P = `r round(anova_dmc_pop["population", "Pr(>F)"], 5)`). Sampling block effects were significant for all traits, indicating temporal patterns. There is also a significant population x block interaction.

**Coastal vs Inland Effects:** Comparing coastal (Percos, Pt. Conception) versus inland (Cojo, Perry) populations revealed significant location type effects for dry matter content (F = `r round(anova_dmc_location["location_type", "F"], 2)`, P = `r round(anova_dmc_location["location_type", "Pr(>F)"], 3)`) and relative water content (F = `r round(anova_rwc_location["location_type", "F"], 2)`, P = `r round(anova_rwc_location["location_type", "Pr(>F)"], 3)`). Sampling block effects were significant for all traits, indicating temporal patterns. There is also a significant population x block interaction.

```{r}
#| label: tbl-anova-rwc-pop
#| tbl-cap: "ANOVA: Relative Water Content (Population effects)"
#| echo: false

library(kableExtra)

anova_rwc_pop %>%
  kable(digits = c(0, 4, 0, 4, 2, 5)) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

```{r}
#| label: tbl-anova-dmc-pop
#| tbl-cap: "ANOVA: Dry Matter Content (Population effects)"
#| echo: false

anova_dmc_pop %>%
  kable(digits = c(0, 4, 0, 4, 2, 5)) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

```{r}
#| label: tbl-anova-rwc-location
#| tbl-cap: "ANOVA: Relative Water Content (Coastal vs Inland)"
#| echo: false

anova_rwc_location %>%
  kable(digits = c(0, 4, 0, 4, 2, 5)) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

```{r}
#| label: tbl-anova-dmc-location
#| tbl-cap: "ANOVA: Dry Matter Content (Coastal vs Inland)"
#| echo: false

anova_dmc_location %>%
  kable(digits = c(0, 4, 0, 4, 2, 5)) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

## Trait Distribution Patterns

```{r fig-histograms-by-block, echo=FALSE, fig.cap="Histograms of key tissue economics traits by population and temporal block. Coastal populations (Percos, Pt. Conception) are shown in blue tones, inland populations (Cojo, Perry) in orange tones.", fig.width=12, fig.height=10}
# Create color palette for populations
pop_colors <- c("Percos" = "#2E86AB", "Pt. Conception" = "#A23B72", 
                "Cojo" = "#F18F01", "Perry" = "#C73E1D")

# Dry Matter Content histograms
p1 <- ggplot(data, aes(x = dry_matter_content, fill = population)) +
  geom_histogram(alpha = 0.7, bins = 20) +
  facet_grid(population ~ block) +
  scale_fill_manual(values = pop_colors) +
  labs(title = "Dry Matter Content Distribution",
       x = "Dry Matter Content (g/g)", y = "Frequency") +
  theme_minimal() +
  theme(legend.position = "none")

# Relative Water Content histograms  
p2 <- ggplot(data, aes(x = relative_water_content, fill = population)) +
  geom_histogram(alpha = 0.7, bins = 20) +
  facet_grid(population ~ block) +
  scale_fill_manual(values = pop_colors) +
  labs(title = "Relative Water Content Distribution",
       x = "Relative Water Content (%)", y = "Frequency") +
  theme_minimal() +
  theme(legend.position = "none")

# Water per dry mass histograms
p3 <- ggplot(data, aes(x = water_per_dry_mass, fill = population)) +
  geom_histogram(alpha = 0.7, bins = 20) +
  facet_grid(population ~ block) +
  scale_fill_manual(values = pop_colors) +
  labs(title = "Water per Dry Mass Distribution",
       x = "Water/Dry Mass (g/g)", y = "Frequency") +
  theme_minimal() +
  theme(legend.position = "none")

# Arrange plots
grid.arrange(p1, p2, p3, ncol = 1)
```

## Coastal vs Inland Comparison

```{r fig-coastal-inland-plots, echo=FALSE, fig.cap="Comparison of tissue economics traits between coastal and inland populations across temporal blocks.", fig.width=10, fig.height=8}
# Coastal vs Inland boxplots
p4 <- ggplot(data, aes(x = block, y = dry_matter_content, fill = location_type)) +
  geom_boxplot(position = position_dodge(width = 0.8)) +
  scale_fill_manual(values = c("Coastal" = "#2E86AB", "Inland" = "#F18F01")) +
  labs(title = "Dry Matter Content: Coastal vs Inland",
       x = "Temporal Block", y = "Dry Matter Content (g/g)",
       fill = "Location Type") +
  theme_minimal()

p5 <- ggplot(data, aes(x = block, y = relative_water_content, fill = location_type)) +
  geom_boxplot(position = position_dodge(width = 0.8)) +
  scale_fill_manual(values = c("Coastal" = "#2E86AB", "Inland" = "#F18F01")) +
  labs(title = "Relative Water Content: Coastal vs Inland",
       x = "Temporal Block", y = "Relative Water Content (%)",
       fill = "Location Type") +
  theme_minimal()

p6 <- ggplot(data, aes(x = block, y = water_per_dry_mass, fill = location_type)) +
  geom_boxplot(position = position_dodge(width = 0.8)) +
  scale_fill_manual(values = c("Coastal" = "#2E86AB", "Inland" = "#F18F01")) +
  labs(title = "Water per Dry Mass: Coastal vs Inland",
       x = "Temporal Block", y = "Water/Dry Mass (g/g)",
       fill = "Location Type") +
  theme_minimal()

grid.arrange(p4, p5, p6, ncol = 1)
```

## Tissue Economics Strategies

```{r fig-dmc, echo=FALSE, fig.cap="Dry matter content across populations and temporal blocks. Lower DMC indicates more water-rich, expensive tissues while higher DMC suggests more economical tissue construction. Coastal populations shown in blue tones, inland in orange tones.", fig.width=8, fig.height=5}
ggplot(data, aes(x = block, y = dry_matter_content, color = population, group = population)) +
  stat_summary(fun = mean, geom = "point", position = position_dodge(width = 0.2), size = 3) +
  stat_summary(fun = mean, geom = "line", position = position_dodge(width = 0.2)) +
  stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.2, position = position_dodge(width = 0.2)) +
  scale_color_manual(values = c("Percos" = "#2E86AB", "Pt. Conception" = "#A23B72", 
                               "Cojo" = "#F18F01", "Perry" = "#C73E1D")) +
  labs(title = "Dry Matter Content Across Populations and Time",
       x = "Temporal Block", y = "Dry Matter Content (g/g)",
       color = "Population") +
  theme_minimal() +
  theme(legend.position = "bottom")
```

```{r fig-rwc, echo=FALSE, fig.cap="Relative water content (RWC) across populations and temporal blocks. Higher RWC indicates greater water storage capacity and tissue hydration. Coastal populations shown in blue tones, inland in orange tones.", fig.width=8, fig.height=5}
ggplot(data, aes(x = block, y = relative_water_content, color = population, group = population)) +
  stat_summary(fun = mean, geom = "point", position = position_dodge(width = 0.2), size = 3) +
  stat_summary(fun = mean, geom = "line", position = position_dodge(width = 0.2)) +
  stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.2, position = position_dodge(width = 0.2)) +
  scale_color_manual(values = c("Percos" = "#2E86AB", "Pt. Conception" = "#A23B72", 
                               "Cojo" = "#F18F01", "Perry" = "#C73E1D")) +
  labs(title = "Relative Water Content Across Populations and Time",
       x = "Temporal Block", y = "Relative Water Content (%)",
       color = "Population") +
  theme_minimal() +
  theme(legend.position = "bottom")
```

## Trait Relationships and Coordination

```{r correlation-analysis, echo=FALSE}
# Correlation matrix
enhanced_traits <- data %>%
  select(wet_wgt, dry_wgt, relative_water_content, water_per_dry_mass, dry_matter_content)

cor_matrix <- cor(enhanced_traits, use = "complete.obs")
```

```{r}
#| label: tbl-correlation-matrix
#| tbl-cap: "Correlation matrix among petal traits"
#| echo: false

# Present correlation matrix as table
cor_df % 
  mutate(Trait = rownames(cor_df)) %>%
  select(Trait, everything())

kable(cor_df)
```

Strong negative correlations between dry matter content and water content metrics (r = `r round(cor_matrix["dry_matter_content", "relative_water_content"], 2)`) confirm the fundamental trade-off between structural investment and water storage capacity in petal tissues.

## Population Divergence in Physiological Strategies

```{r mantel-tests, echo=FALSE, results='hide'}
# Mantel test analysis
trait_cols <- c("wet_wgt", "dry_wgt", "relative_water_content", "water_per_dry_mass", "dry_matter_content")

valid_cor_matrix <- function(df, traits) {
  mat <- cor(df[, traits], use = "complete.obs")
  complete_obs <- sum(complete.cases(df[, traits]))
  if (nrow(mat) > 1 && complete_obs >= 4 && all(!is.na(mat))) return(mat) else return(NULL)
}

# Population comparisons
pop_levels <- unique(data$population)
mantel_results <- list()

if (length(pop_levels) >= 2) {
  for (i in 1:(length(pop_levels) - 1)) {
    for (j in (i + 1):length(pop_levels)) {
      pop_i <- pop_levels[i]
      pop_j <- pop_levels[j]
      mat_i <- valid_cor_matrix(subset(data, population == pop_i), trait_cols)
      mat_j <- valid_cor_matrix(subset(data, population == pop_j), trait_cols)
      if (!is.null(mat_i) && !is.null(mat_j)) {
        mantel_res <- mantel(as.dist(mat_i), as.dist(mat_j), permutations = 999)
        mantel_results[[paste(pop_i, pop_j, sep = "_vs_")]] <- mantel_res
      }
    }
  }
}
```

Mantel tests comparing correlation structures between populations revealed significant differences in trait coordination patterns (P = 0.008), suggesting divergent physiological strategies among populations.

# Discussion

Our analysis of petal water content traits across four populations of *Eschscholzia californica* at the Dangermond Preserve reveals ...... The observed patterns are consistent with tissue economics theory operating at fine spatial scales, where ......

## Microgeographic Adaptation to Substrate and Salt Exposure

The variation in tissue economics metrics among populations separated by less than 2 km demonstrates the potential for fine-scale physiological adaptation in coastal environments. The contrast between the coastal dune Pt. Conception population and the inland shale populations (Perry, Percos, Cojo) provides insight into how substrate type and proximity to ocean influence petal construction strategies. The dune population at Pt. Conception is less different from the other populations than the Percos population

## Implications for Coastal Plant Ecophysiology

The microgeographic scale of this study highlights how environmental heterogeneity in coastal zones can drive physiological divergence even among nearby populations. The gradient from exposed coastal dune to protected inland shale hillsides represents distinct selective pressures that may favor different petal tissue economics strategies. Populations experiencing higher salt exposure and sandy substrates may invest in more economical, stress-tolerant tissues, while those in more protected environments may afford more expensive, water-rich tissues for enhanced pollinator attraction.

## Substrate Effects on Water Relations

The contrast between dune sand (Pt. Conception) and shale substrates (Percos, Perry, Cojo) provides a natural experiment in how substrate properties influence plant water relations and tissue construction. Shale substrates typically retain more moisture but may present different nutritional constraints compared to sandy soils, potentially driving divergent resource allocation strategies in reproductive tissues.

## Future Directions

The addition of petal area measurements will enable calculation of specific petal area and mass per area metrics, providing deeper insights into the construction costs and functional consequences of different tissue economics strategies. These metrics will be particularly valuable for understanding the relationship between petal morphology and physiological performance.

# Conclusions

This study demonstrates significant microgeographic variation in petal tissue economics traits across four populations of *Eschscholzia californica* within a 2 km radius at the Dangermond Preserve. The observed variation suggests that floral physiology can be subject to fine-scale local adaptation, even among closely spaced populations. The framework developed here provides insights into how coastal environmental gradients, including substrate type, salt exposure, and proximity to ocean, shape resource allocation strategies in reproductive tissues. These findings contribute to our understanding of plant responses to environmental heterogeneity at microgeographic scales and highlight the importance of considering fine-scale variation in ecophysiological studies of coastal plant communities.

# Appendix

```{r appendix-code, eval=FALSE}
# R code for calculating tissue economics metrics
data <- data %>%
  mutate(
    relative_water_content = ((wet_wgt - dry_wgt) / wet_wgt) * 100,
    water_per_dry_mass = (wet_wgt - dry_wgt) / dry_wgt,
    dry_matter_content = dry_wgt / wet_wgt
  )

# Future petal area metrics (add when area data available)
# data <- data %>%
#   mutate(
#     specific_petal_area = petal_area / dry_wgt,
#     petal_mass_per_area = dry_wgt / petal_area,
#     fresh_mass_per_area = wet_wgt / petal_area
#   )
```
